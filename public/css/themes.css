/* Light mode palette */
@media (prefers-color-scheme: light) {
  :root:not([data-theme="dark"]) {
    --bg-dark: #FAF6F1;
    --bg-card: #FFFFFF;
    --bg-slot: #F0EBE4;
    --bg-slot-hover: #E8E1D8;
    --border: #D4CBC0;
    --fridge-bg: #E8EEF2;
    --slot-text-primary: #3E352D;  /* Phase 3.5.1: 9.8:1 on sand bg, high contrast */
    --fridge-bg-fallback: #E8EEF2;
    --text: #2C2420;
    --text-muted: #6B5F54;
    --text-secondary: #7A6E63;
    --accent: #7A6240;
    --accent-hover: #634F33;
    --accent-rgb: 122, 98, 64;
    --red-wine: #8B2332;
    --white-wine: #B8960A;
    --rose-wine: #C4646E;
    --sparkling: #9E8A1E;
    --wine-red: var(--red-wine);
    --wine-white: var(--white-wine);
    --wine-rose: var(--rose-wine);
    --wine-sparkling: var(--sparkling);
    --priority-1: #D93636;
    --priority-2: #D97020;
    --priority-3: #C49A20;
    --gold: #B8960A;
    --primary: var(--accent);
    --color-success: #2E7D32;
    --color-success-muted: #388E3C;
    --color-success-bg: rgba(46, 125, 50, 0.12);
    --color-error: #C62828;
    --color-error-muted: #D32F2F;
    --color-error-bg: rgba(198, 40, 40, 0.1);
    --color-warning: #E65100;
    --color-warning-muted: #EF6C00;
    --color-warning-bg: rgba(230, 81, 0, 0.1);
    --color-info: #1565C0;
    --color-info-bg: rgba(21, 101, 192, 0.1);
    --color-caution: #F57F17;
    --color-caution-muted: #F9A825;
    --color-caution-bg: rgba(245, 127, 23, 0.1);
    --color-fragmented: #7B1FA2;
    --color-fragmented-muted: #9C27B0;
    --color-fragmented-bg: rgba(123, 31, 162, 0.1);
    --color-hold: #1565C0;
    --color-hold-bg: rgba(21, 101, 192, 0.1);
    --color-gold-medal: #C49000;
    --color-silver-medal: #757575;
    --color-bronze-medal: #8D6E34;
    --text-on-light: #2C2420;
    --text-on-accent: #FFFFFF;
    --color-success-rgb: 46, 125, 50;
    --color-error-rgb: 198, 40, 40;
    --color-warning-rgb: 230, 81, 0;
    --color-caution-rgb: 245, 127, 23;
    --color-info-rgb: 21, 101, 192;
    --color-hold-rgb: 21, 101, 192;
    --color-fragmented-rgb: 123, 31, 162;
    --color-gold-rgb: 196, 144, 0;
    --color-silver-rgb: 117, 117, 117;
    --color-bronze-rgb: 141, 110, 52;
    --color-gray-500-rgb: 107, 95, 84;
  }
}

/* Explicit override (user picks light in Settings) */
:root[data-theme="light"] {
  --bg-dark: #FAF6F1;
  --bg-card: #FFFFFF;
  --bg-slot: #F0EBE4;
  --bg-slot-hover: #E8E1D8;
  --border: #D4CBC0;
  --fridge-bg: #E8EEF2;
  --slot-text-primary: #3E352D;  /* Phase 3.5.1: 9.8:1 on sand bg */
  --fridge-bg-fallback: #E8EEF2;
  --text: #2C2420;
  --text-muted: #6B5F54;
  --text-secondary: #7A6E63;
  --accent: #7A6240;
  --accent-hover: #634F33;
  --accent-rgb: 122, 98, 64;
  --red-wine: #8B2332;
  --white-wine: #B8960A;
  --rose-wine: #C4646E;
  --sparkling: #9E8A1E;
  --wine-red: var(--red-wine);
  --wine-white: var(--white-wine);
  --wine-rose: var(--rose-wine);
  --wine-sparkling: var(--sparkling);
  --priority-1: #D93636;
  --priority-2: #D97020;
  --priority-3: #C49A20;
  --gold: #B8960A;
  --primary: var(--accent);
  --color-success: #2E7D32;
  --color-success-muted: #388E3C;
  --color-success-bg: rgba(46, 125, 50, 0.12);
  --color-error: #C62828;
  --color-error-muted: #D32F2F;
  --color-error-bg: rgba(198, 40, 40, 0.1);
  --color-warning: #E65100;
  --color-warning-muted: #EF6C00;
  --color-warning-bg: rgba(230, 81, 0, 0.1);
  --color-info: #1565C0;
  --color-info-bg: rgba(21, 101, 192, 0.1);
  --color-caution: #F57F17;
  --color-caution-muted: #F9A825;
  --color-caution-bg: rgba(245, 127, 23, 0.1);
  --color-fragmented: #7B1FA2;
  --color-fragmented-muted: #9C27B0;
  --color-fragmented-bg: rgba(123, 31, 162, 0.1);
  --color-hold: #1565C0;
  --color-hold-bg: rgba(21, 101, 192, 0.1);
  --color-gold-medal: #C49000;
  --color-silver-medal: #757575;
  --color-bronze-medal: #8D6E34;
  --text-on-light: #2C2420;
  --text-on-accent: #FFFFFF;
  --color-success-rgb: 46, 125, 50;
  --color-error-rgb: 198, 40, 40;
  --color-warning-rgb: 230, 81, 0;
  --color-caution-rgb: 245, 127, 23;
  --color-info-rgb: 21, 101, 192;
  --color-hold-rgb: 21, 101, 192;
  --color-fragmented-rgb: 123, 31, 162;
  --color-gold-rgb: 196, 144, 0;
  --color-silver-rgb: 117, 117, 117;
  --color-bronze-rgb: 141, 110, 52;
  --color-gray-500-rgb: 107, 95, 84;
}

/* Light mode component overrides (flattened — no CSS nesting for browser compat)
   Phase 3.5: WCAG AA compliance, 60-30-10 hierarchy, figure-ground separation.
   Duplicated for @media (system) and [data-theme] (explicit) paths. */

/* === System light mode (@media path) === */
@media (prefers-color-scheme: light) {
  /* Accent-background elements: darker bg + white text for AA contrast (7:1 on #634F33) */
  :root:not([data-theme="dark"]) .toggle-btn.active,
  :root:not([data-theme="dark"]) .award-badge,
  :root:not([data-theme="dark"]) .zone-chat-panel .chat-message.user .chat-content,
  :root:not([data-theme="dark"]) .zone-order,
  :root:not([data-theme="dark"]) .recommendation-card .rank-badge {
    background: var(--accent-hover);
    color: white;
  }

  /* Tab active: white text on dark light-mode accent (5.2:1) */
  :root:not([data-theme="dark"]) .tab.active {
    color: var(--text-on-accent);
  }

  /* Wizard progress dots */
  :root:not([data-theme="dark"]) .onboarding-progress .step.active::before,
  :root:not([data-theme="dark"]) .onboarding-progress .step.completed::before {
    color: var(--text-on-light);
  }

  /* Reduce heavy box-shadows for light backgrounds */
  :root:not([data-theme="dark"]) .global-search-modal {
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
  }

  :root:not([data-theme="dark"]) .auth-card {
    box-shadow: 0 24px 60px rgba(0, 0, 0, 0.18);
  }

  :root:not([data-theme="dark"]) [class*="notification"],
  :root:not([data-theme="dark"]) [class*="announcement"] {
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
  }

  /* Phase 3.5.1: Slot text contrast fix (WCAG AA — 9.8:1 ratio) */
  :root:not([data-theme="dark"]) .slot-name,
  :root:not([data-theme="dark"]) .slot-vintage,
  :root:not([data-theme="dark"]) .slot.empty .slot-loc {
    color: var(--slot-text-primary);
    opacity: 1;
    font-weight: 500;
  }

  /* Override empty slot opacity suppression in light mode */
  :root:not([data-theme="dark"]) .slot.empty {
    opacity: 0.75;
  }

  :root:not([data-theme="dark"]) .slot.empty:hover {
    opacity: 0.9;
  }

  /* Phase 3.5.2: Strengthen primary CTA (WCAG + 60-30-10 accent layer) */
  :root:not([data-theme="dark"]) .btn-primary,
  :root:not([data-theme="dark"]) .confirm-dialog-confirm {
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2), 0 1px 3px rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(0, 0, 0, 0.15);
    font-weight: 600;
    background: var(--accent-hover);    /* #634F33 — darker shade */
    color: var(--text-on-accent);       /* white — 6.8:1 on #634F33, passes AA */
  }

  :root:not([data-theme="dark"]) .btn-primary:hover,
  :root:not([data-theme="dark"]) .confirm-dialog-confirm:hover {
    filter: brightness(0.9);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25), 0 2px 4px rgba(0, 0, 0, 0.15);
  }

  /* Phase 3.5.3: Figure-ground separation (60-30-10 card layer) */
  :root:not([data-theme="dark"]) .slot,
  :root:not([data-theme="dark"]) .wine-card,
  :root:not([data-theme="dark"]) .modal,
  :root:not([data-theme="dark"]) .settings-section {
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12);
  }

  :root:not([data-theme="dark"]) .slot:hover,
  :root:not([data-theme="dark"]) .wine-card:hover {
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.18);
  }
}

/* === Explicit light mode ([data-theme="light"] path) === */

/* Accent-background elements: darker bg + white text for AA contrast (7:1 on #634F33) */
:root[data-theme="light"] .toggle-btn.active,
:root[data-theme="light"] .award-badge,
:root[data-theme="light"] .zone-chat-panel .chat-message.user .chat-content,
:root[data-theme="light"] .zone-order,
:root[data-theme="light"] .recommendation-card .rank-badge {
  background: var(--accent-hover);
  color: white;
}

/* Tab active: white text on dark light-mode accent (5.2:1) */
:root[data-theme="light"] .tab.active {
  color: var(--text-on-accent);
}

/* Wizard progress dots */
:root[data-theme="light"] .onboarding-progress .step.active::before,
:root[data-theme="light"] .onboarding-progress .step.completed::before {
  color: var(--text-on-light);
}

/* Reduce heavy box-shadows for light backgrounds */
:root[data-theme="light"] .global-search-modal {
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
}

:root[data-theme="light"] .auth-card {
  box-shadow: 0 24px 60px rgba(0, 0, 0, 0.18);
}

:root[data-theme="light"] [class*="notification"],
:root[data-theme="light"] [class*="announcement"] {
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
}

/* Phase 3.5.1: Slot text contrast fix */
:root[data-theme="light"] .slot-name,
:root[data-theme="light"] .slot-vintage,
:root[data-theme="light"] .slot.empty .slot-loc {
  color: var(--slot-text-primary);
  opacity: 1;
  font-weight: 500;
}

/* Override empty slot opacity suppression */
:root[data-theme="light"] .slot.empty {
  opacity: 0.75;
}

:root[data-theme="light"] .slot.empty:hover {
  opacity: 0.9;
}

/* Phase 3.5.2: Strengthen primary CTA */
:root[data-theme="light"] .btn-primary,
:root[data-theme="light"] .confirm-dialog-confirm {
  box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2), 0 1px 3px rgba(0, 0, 0, 0.1);
  border: 1px solid rgba(0, 0, 0, 0.15);
  font-weight: 600;
  background: var(--accent-hover);    /* #634F33 — darker shade */
  color: var(--text-on-accent);       /* white — 6.8:1 on #634F33, passes AA */
}

:root[data-theme="light"] .btn-primary:hover,
:root[data-theme="light"] .confirm-dialog-confirm:hover {
  filter: brightness(0.9);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25), 0 2px 4px rgba(0, 0, 0, 0.15);
}

/* Phase 3.5.3: Figure-ground separation */
:root[data-theme="light"] .slot,
:root[data-theme="light"] .wine-card,
:root[data-theme="light"] .modal,
:root[data-theme="light"] .settings-section {
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12);
}

:root[data-theme="light"] .slot:hover,
:root[data-theme="light"] .wine-card:hover {
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.18);
}

/* High contrast mode support */
@media (prefers-contrast: high) {
  :root {
    --border: var(--hc-border);
    --text-muted: var(--hc-text-muted);
  }

  .btn {
    border: 2px solid currentColor;
  }

  .slot {
    border: 1px solid var(--text-muted);
  }
}
